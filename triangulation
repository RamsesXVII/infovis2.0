from itertools import product

def getCatalanNumber(n):
    return catnumber(n-2)

def catnumber(n):
    ans = 1.0
    for k in range(2,n+1):
     ans = ans *(n+k)/k
    return int(ans)

def triangulations(p,randInt):
    result = []
    n = len(p)
    if n == 2:
         result.append([])
    elif n == 3:
         result.append([p])
    else:
        counter=0

        for k in range(1, n - 1):
            leftT=p[:k + 1]
            rightT=p[k:]

            leftCat=getCatalanNumber(len(leftT))
            rightCat=getCatalanNumber(len(rightT))

            prodOfCat=leftCat*rightCat

            if randInt<=(prodOfCat+counter):
                delta=randInt-counter
                randLeft=int(delta/rightCat)

                if(rightCat!=1):
                    randLeft+=1

                randRight=int(delta%rightCat)

                if(randRight==0):
                    randRight=rightCat

                for u, v in product(triangulations(leftT,randLeft), triangulations(rightT,randRight)):
                    result.append( u + [(p[0], p[k], p[-1])] + v)

                return result

            else:
                counter+=prodOfCat
    return result

triangulation=set()
for i in range(1,133):
    tr=triangulations(tuple("12345678"),i)
    print(tr)
    print(i)
    if (str(tr) in triangulation):
        print("***************")
    triangulation.add(str(tr))

print(len(triangulation))
print(getCatalanNumber(8))
